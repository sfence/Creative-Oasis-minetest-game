name: GitHub ‚Üí Discord Notify

on:
  push:
  pull_request:
  issues:
  release:
  fork:
  watch:
  create:
  delete:

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord message
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          DISCORD_MESSAGE: |
            üìå **GitHub Event Notification**
            **Repository:** [${{ github.repository }}](https://github.com/${{ github.repository }})
            **Event:** ${{ github.event_name }}
            **Actor:** [${{ github.actor }}](https://github.com/${{ github.actor }})

            # PRs ‚Äî simple info to avoid fork issues
            ${{ github.event_name == 'pull_request' && format('**Pull Request Event** by %s', github.actor) || '' }}

            # Push commits
            ${{ github.event_name == 'push' && format('**Commits:**\n%s', join(github.event.commits.*.message, '\n')) || '' }}

            # Issues
            ${{ github.event_name == 'issues' && format('**Issue:** [%s](%s)', github.event.issue.title, github.event.issue.html_url) || '' }}

            # Release
            ${{ github.event_name == 'release' && format('**Release:** [%s](%s)', github.event.release.name, github.event.release.html_url) || '' }}

            # Fork
            ${{ github.event_name == 'fork' && format('**Forked Repo:** [%s](%s) by [%s](https://github.com/%s)', github.event.forkee.full_name, github.event.forkee.html_url, github.event.forkee.owner.login, github.event.forkee.owner.login) || '' }}

            # Watch (stars)
            ${{ github.event_name == 'watch' && format('‚≠ê %s starred the repository', github.actor) || '' }}

            # Create/Delete
            ${{ github.event_name == 'create' && format('**Created %s:** %s', github.event.ref_type, github.event.ref) || '' }}
            ${{ github.event_name == 'delete' && format('**Deleted %s:** %s', github.event.ref_type, github.event.ref) || '' }}
