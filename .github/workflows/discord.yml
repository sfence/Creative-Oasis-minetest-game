name: GitHub ‚Üí Discord Notify

on:
  push:
  pull_request:       # PRs from the same repo
  pull_request_target: # PRs from forks
  issues:
  release:
  fork:
  watch:
  create:
  delete:

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord message
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          DISCORD_MESSAGE: |
            üìå **GitHub Event Notification**

            **Repository:** [${{ github.repository }}](https://github.com/${{ github.repository }})
            **Event:** ${{ github.event_name }}
            **Actor:** [${{ github.actor }}](https://github.com/${{ github.actor }})

            ${{ github.event_name == 'push' && format('**Commits:**\n%s', join(github.event.commits.*.message, '\n')) || '' }}

            # PRs (handles both pull_request and pull_request_target safely)
            ${{ (github.event_name == 'pull_request' || github.event_name == 'pull_request_target') && format('**Pull Request:** [%s](%s) by [%s](https://github.com/%s)', github.event.pull_request.title || 'N/A', github.event.pull_request.html_url || 'N/A', github.event.pull_request.user.login || github.actor, github.event.pull_request.user.login || github.actor) || '' }}

            ${{ github.event_name == 'issues' && format('**Issue:** [%s](%s)', github.event.issue.title, github.event.issue.html_url) || '' }}

            ${{ github.event_name == 'release' && format('**Release:** [%s](%s)', github.event.release.name, github.event.release.html_url) || '' }}

            ${{ github.event_name == 'fork' && format('**Forked Repo:** [%s](%s) by [%s](https://github.com/%s)', github.event.forkee.full_name, github.event.forkee.html_url, github.event.forkee.owner.login, github.event.forkee.owner.login) || '' }}

            ${{ github.event_name == 'watch' && format('‚≠ê %s starred the repository', github.actor) || '' }}

            ${{ github.event_name == 'create' && format('**Created %s:** %s', github.event.ref_type, github.event.ref) || '' }}

            ${{ github.event_name == 'delete' && format('**Deleted %s:** %s', github.event.ref_type, github.event.ref) || '' }}
